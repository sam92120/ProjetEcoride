{# templates/mon_compte/covoiturage.html.twig #}
{% extends 'base.html.twig' %}

{% block title %}Covoiturage{% endblock %}

{% block body %}
<div class="container mt-5 mb-5">
    <h1 class="text-center mb-4">Covoiturage</h1>
    <p class="text-center">Voyager ensemble, Ã©conomiser et partager des moments conviviaux!</p>

    {% if covoiturages is empty %}
        <div class="alert alert-info text-center ">Aucun covoiturage trouvÃ©.</div>
    {% else %}
        <div class="row">
            {% for covoiturage in covoiturages %}
                <div class="col-12 mb-3">
                    <div class="card shadow-sm rounded-3 border-4 h-100">
                        <div class="card-body">
                           
                            
                
                            <p class="card-text">
                                
                                    <img src="{{ asset('uploads/photos/' ~ covoiturage.user.photo) }}" alt="photo de {{ covoiturage.user.pseudo }}" width="60" height="60" class="rounded-circle">
                               
                               
                            </p>

                            <p class="card-text">
                                <strong>Conducteur :</strong> {{ covoiturage.user.nom ?? 'non renseignÃ©' }} {{ covoiturage.user.prenom ?? 'non renseignÃ©' }}
                            </p>
                        
                            <p class="card-text">
                                {% if covoiturage.nbplace > 0  %}
                                        <p class="bi bi-person"></p> {{ covoiturage.nbplace }} 
                                        place{% if covoiturage.nbplace > 1 %}{% endif %} 
                                        restante{% if covoiturage.nbplace > 1 %}{% endif %}
                                {% else %}
                                <span class="text-danger fw-bold"><i class="bi bi-x-circle"></i> Complet</span>
                                {% endif %}
                                <br>
                            </p>


                            <p class="card-title">
                                <strong>{{ covoiturage.lieudepart }} â†’ {{ covoiturage.lieuarrivee }}</strong>
                            </p>

                            <p class="card-subtitle mb-2 text-muted">
                                DÃ©part le <strong>{{ covoiturage.dateDepart|date('d/m/Y') }}</strong>
                            </p>

                            <p class="card-text">
                                <strong>Prix par personne :</strong> {{ covoiturage.prixpersonne }} â‚¬
                            </p>

                            <p class="card-text">
                                <strong>Voiture :</strong> {{ covoiturage.voiture.marque ?? 'non renseignÃ©' }} {{ covoiturage.voiture.modele ?? 'non renseignÃ©' }}
                            </p>

                            <p class="card-text">
                                {% if covoiturage.voiture.energie in ['electrique', 'hybride'] %}
                                    Voyage Ã©cologique ðŸŒ±ðŸŒ± 
                                {% elseif covoiturage.voiture.energie in ['essence', 'diesel'] %}
                                    Ã‰nergie non Ã©cologique ðŸš—
                                {% else %}
                                    Ã‰nergie autre / non renseignÃ©e
                                {% endif %}

                            </p>    

                            


                            <a href="{{ path('app_covoiturage_information', {'id': covoiturage.id}) }}" class="btn btn-primary mt-3 w-100">Voir les dÃ©tails</a>   

                        


                            {% if covoiturage.nbplace >= 3 and app.user %}
                                <form action="{{ path('app_covoiturage_reserver', {'id': covoiturage.id}) }}" method="post" class="d-inline">
                                    <input type="hidden" name="_token" value="{{ csrf_token('covoiturage_reserver' ~ covoiturage.id) }}">
                                    <button class="btn btn-primary btn-sm">RÃ©server</button>
                                </form>
                                
                                <a href="{{ path('app_compte') }}" class="btn btn-secondary btn-sm">compte</a>
                            {% endif %}
                        </div>
                    </div>
                </div>
            {% endfor %}
        </div>
    {% endif %}
</div>


{% endblock %}
